"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9624],{39024:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>E,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var o=i(74848),t=i(28453);const s={title:"Environment Variables"},a=void 0,l={id:"deploy/steedos-config",title:"Environment Variables",description:"This page provides instructions on how to configure your self-hosted Steedos instance.",source:"@site/docs/deploy/steedos-config.md",sourceDirName:"deploy",slug:"/deploy/steedos-config",permalink:"/deploy/steedos-config",draft:!1,unlisted:!1,editUrl:"https://github.com/steedos/steedos-docs/tree/master/docs/deploy/steedos-config.md",tags:[],version:"current",frontMatter:{title:"Environment Variables"},sidebar:"platform",previous:{title:"Try with Gitpod",permalink:"/deploy/gitpod"},next:{title:"Building Applications",permalink:"/no-code/application/"}},r={},c=[{value:"Required Configuration",id:"required-configuration",level:2},{value:"Login Screen",id:"login-screen",level:2},{value:"Attachment Storage",id:"attachment-storage",level:2},{value:"Local File System",id:"local-file-system",level:3},{value:"S3",id:"s3",level:3},{value:"Attachment Anonymous Download",id:"attachment-anonymous-download",level:3},{value:"Push Notifications",id:"push-notifications",level:2},{value:"Email Configuration",id:"email-configuration",level:2},{value:"OIDC Authentication",id:"oidc-authentication",level:2},{value:"Scheduled Tasks",id:"scheduled-tasks",level:2},{value:"Developer Options",id:"developer-options",level:2},{value:"Account-related",id:"account-related",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"This page provides instructions on how to configure your self-hosted Steedos instance."}),"\n",(0,o.jsx)(n.h2,{id:"required-configuration",children:"Required Configuration"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Platform\nPORT=80\nROOT_URL=http://localhost\n\n# Database\nMONGO_URL=mongodb://127.0.0.1:27017/steedos\nMONGO_OPLOG_URL=mongodb://127.0.0.1:27017/local\n\n# Microservices communication [https://moleculer.services/docs/0.14/networking.html](https://moleculer.services/zh/docs/0.14/networking.html)\nTRANSPORTER=redis://127.0.0.1:6379\n\n# Caching https://moleculer.services/zh/docs/0.14/caching.html\nCACHER=redis://127.0.0.1:6379/1\n\n"})}),"\n",(0,o.jsx)(n.h2,{id:"login-screen",children:"Login Screen"}),"\n",(0,o.jsx)(n.p,{children:"Configure login screen related parameters, such as whether registration is allowed, whether password modification is permitted, whether company creation is allowed."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Allow account creation, default is true when the database is empty\nSTEEDOS_TENANT_ENABLE_REGISTER=true  \n# Allow password recovery, setting to true will display a link to retrieve the password, default is false.\nSTEEDOS_TENANT_ENABLE_FORGET_PASSWORD=true  \n# Allow creation of companies, by default only allowed when the database is empty\nSTEEDOS_TENANT_ENABLE_CREATE_TENANT=false \n# Allow password login, enabled by default for both registration and login. Default is true\nSTEEDOS_TENANT_ENABLE_PASSWORD_LOGIN=true \n# Mandatory email binding, email input and verification required after login. Default is false\nSTEEDOS_TENANT_ENABLE_BIND_EMAIL=false \n# Mandatory mobile number binding, mobile number input and verification required after login. Default is false\nSTEEDOS_TENANT_ENABLE_BIND_MOBILE=false \n# Allow login using email verification code, default method for both registration and login when enabled.\nSTEEDOS_TENANT_ENABLE_EMAIL_CODE_LOGIN=false \n# Allow login using mobile verification code, default method for both registration and login when enabled.\nSTEEDOS_TENANT_ENABLE_MOBILE_CODE_LOGIN=false \n# Default is a 43-character string, a new value is generated each time the service is restarted\nSTEEDOS_TENANT_TOKEN_SECRET=  \n# Default is 90d\nSTEEDOS_TENANT_ACCESS_TOKEN_EXPIRES_IN= \n# Default is 7d\nSTEEDOS_TENANT_REFRESH_TOKEN_EXPIRES_IN=  \n"})}),"\n",(0,o.jsx)(n.h1,{id:"metadata-synchronization",children:"Metadata Synchronization"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"METADATA_SERVER=http://localhost:5000\nMETADATA_APIKEY=\n"})}),"\n",(0,o.jsx)(n.h2,{id:"attachment-storage",children:"Attachment Storage"}),"\n",(0,o.jsx)(n.p,{children:"Configure parameters related to attachment storage."}),"\n",(0,o.jsx)(n.h3,{id:"local-file-system",children:"Local File System"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"STEEDOS_CFS_STORE=local\nSTEEDOS_STORAGE_DIR=/steedos-storage\n"})}),"\n",(0,o.jsx)(n.h3,{id:"s3",children:"S3"}),"\n",(0,o.jsx)(n.p,{children:"Attachments can be stored on servers supporting the S3 protocol, including AWS, Alibaba Cloud, Tencent Cloud storage services, or privately deployed minio services."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"STEEDOS_CFS_STORE=S3\nSTEEDOS_CFS_AWS_S3_ENDPOINT=http://minio:9000\nSTEEDOS_CFS_AWS_S3_FORCE_PATH_STYLE=true\nSTEEDOS_CFS_AWS_S3_BUCKET=steedos-prod\nSTEEDOS_CFS_AWS_S3_ACCESS_KEY_ID=${MINIO_ROOT_USER:-steedos} \nSTEEDOS_CFS_AWS_S3_SECRET_ACCESS_KEY=${MINIO_ROOT_PASSWORD:-steedos123}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"attachment-anonymous-download",children:"Attachment Anonymous Download"}),"\n",(0,o.jsx)(n.p,{children:"By default, uploaded avatars, images, and attachments in the system require login for download."}),"\n",(0,o.jsx)(n.p,{children:"The following variable can be set for anonymous downloads."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Options include avatars, images, files, default is avatars\nSTEEDOS_CFS_DOWNLOAD_PUBLIC=avatars,images \n"})}),"\n",(0,o.jsx)(n.h2,{id:"push-notifications",children:"Push Notifications"}),"\n",(0,o.jsx)(n.p,{children:"Configure parameters for mobile push notifications, used for receiving notification messages on the Steedos mobile app."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# iOS\nSTEEDOS_PUSH_APN_DATA=\n\n# Andriod\nSTEEDOS_GCM_APIKEY=\nSTEEDOS_GCM_PROJECT_NUMBER=\n\n# Huawei\nSTEEDOS_PUSH_HUAWEI_APPID=\nSTEEDOS_PUSH_HUAWEI_APPPKGNAME=\nSTEEDOS_PUSH_HUAWEI_APPSECRET=\n\n# Xiaomi\nSTEEDOS_PUSH_MI_APPSECRET=\nSTEEDOS_PUSH_MI_PRODUCTION=\n"})}),"\n",(0,o.jsx)(n.h2,{id:"email-configuration",children:"Email Configuration"}),"\n",(0,o.jsx)(n.p,{children:"Configure SMTP service parameters for system push emails."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"STEEDOS_EMAIL_FROM=\nSTEEDOS_EMAIL_URL=\nSTEEDOS_EMAIL_HOST=\nSTEEDOS_EMAIL_PORT=\nSTEEDOS_EMAIL_USERNAME=\nSTEEDOS_EMAIL_PASSWORD=\nSTEEDOS_EMAIL_SECURE=\nSTEEDOS_EMAIL_SIGNNAME=\n"})}),"\n",(0,o.jsx)(n.h2,{id:"oidc-authentication",children:"OIDC Authentication"}),"\n",(0,o.jsx)(n.p,{children:"Enterprise Edition: Configure parameters for OpenID Connect single sign-on, can connect to Keycloak server."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# OpenID Connect\nSTEEDOS_IDENTITY_OIDC_ENABLED=true\nSTEEDOS_IDENTITY_OIDC_CONFIG_URL=https://id.steedos.cn/realms/master/.well-known/openid-configuration\nSTEEDOS_IDENTITY_OIDC_CLIENT_ID=steedos-oidc-public\nSTEEDOS_IDENTITY_OIDC_CLIENT_SECRET=none\nSTEEDOS_IDENTITY_OIDC_NAME=Steedos ID\nSTEEDOS_IDENTITY_OIDC_LOGO=\nSTEEDOS_IDENTITY_OIDC_REQUIRE_LOCAL_ACCOUNT=false\n"})}),"\n",(0,o.jsx)(n.h2,{id:"scheduled-tasks",children:"Scheduled Tasks"}),"\n",(0,o.jsx)(n.p,{children:"Configure the properties for scheduled tasks."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Time to execute database indexing, like \u201c0 0 * * * *\u201d above means indexing operation is performed once every hour. Existing indexes are not recreated.\nSTEEDOS_CRON_BUILD_INDEX=\"0 0 * * * *\"\n\n# Execution time for workflow rule queue, time-based workflow actions depend on this configuration, like \u201c*/10 * * * * *\u201d above means it's executed every 1 minutes.\nSTEEDOS_CRON_WORKFLOW_RULE='*/1 * * * *'\n\n# Polling interval for the mail queue, in milliseconds.\nSTEEDOS_CRON_MAILQUEUE_INTERVAL=10000\n\n# Polling interval for the push notification queue, in milliseconds.\nSTEEDOS_CRON_PUSH_INTERVAL=1000\n\n# Polling interval for the webhook queue, in milliseconds.\nSTEEDOS_CRON_WEBHOOKQUEUE_INTERVAL=10000\n\n# Polling interval for the instance record queue, in milliseconds.\nSTEEDOS_CRON_INSTANCERECORDQUEUE_INTERVAL=10000\n\n# Polling interval for the SMS queue, in milliseconds.\nSTEEDOS_CRON_SMSQUEUE_INTERVAL=1000\n\n# Polling interval for the object webhooks queue, in milliseconds.\nSTEEDOS_CRON_OBJECTWEBHOOKSQUEUE_INTERVAL=10000\n\n# Polling interval of the object & workflow synchronization queue, in milliseconds.\nSTEEDOS_CRON_INSTANCERECORDQUEUE_INTERVAL=10000\n"})}),"\n",(0,o.jsx)(n.h2,{id:"developer-options",children:"Developer Options"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"STEEDOS_GRAPHQL_ENABLE_CONSOLE=true\nSTEEDOS_UNPKG_URL=https://unpkg.steedos.cn\nSTEEDOS_AMIS_VERSION=2.9.0\nSTEEDOS_PUBLIC_PAGE_ASSETURLS=http://127.0.0.1:8080/@steedos-widgets/amis-object/dist/assets-dev.json\nSTEEDOS_ENABLE_PROCESS_TRIGGER=true\n"})}),"\n",(0,o.jsx)(n.h2,{id:"account-related",children:"Account-related"}),"\n",(0,o.jsx)(n.p,{children:"Configure parameters related to accounts."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"accounts:\n  mobile_phone_locales: ['zh-CN']\n  mobile_regexp: '^[0-9]{11}$'\n  is_username_skip_minrequiredlength: true\n  UTF8_Names_Validation: '[A-Za-z0-9-_.\\u00C0-\\u017F\\u4e00-\\u9fa5]'\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["mobile_phone_locales: This parameter takes precedence. Mobile phone localization, setting it to ",(0,o.jsx)(n.code,{children:"zh-CN"})," means using the 11-digit mobile number in China. To support mobile numbers from other countries, please refer to ",(0,o.jsx)(n.a,{href:"https://www.npmjs.com/package/validator",children:"validator"}),"."]}),"\n",(0,o.jsx)(n.li,{children:"mobile_regexp: Regular expression for mobile phone format, using a regular expression to describe the correct mobile phone format."}),"\n",(0,o.jsx)(n.li,{children:"is_username_skip_minrequiredlength: Whether to skip the minimum character requirement for usernames, which is typically 6 characters by default."}),"\n",(0,o.jsx)(n.li,{children:"UTF8_Names_Validation: Regular expression for username rules."}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"When multiple password rules are configured, they will take effect simultaneously. The rules in the example above are effective at the same time."})]})}function E(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>l});var o=i(96540);const t={},s=o.createContext(t);function a(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);