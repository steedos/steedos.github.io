"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5496],{3905:(e,a,n)=>{n.d(a,{Zo:()=>m,kt:()=>f});var t=n(7294);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function o(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?o(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function l(e,a){if(null==e)return{};var n,t,r=function(e,a){if(null==e)return{};var n,t,r={},o=Object.keys(e);for(t=0;t<o.length;t++)n=o[t],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)n=o[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=t.createContext({}),p=function(e){var a=t.useContext(s),n=a;return e&&(n="function"==typeof e?e(a):i(i({},a),e)),n},m=function(e){var a=p(e.components);return t.createElement(s.Provider,{value:a},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},d=t.forwardRef((function(e,a){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),c=p(n),d=r,f=c["".concat(s,".").concat(d)]||c[d]||u[d]||o;return n?t.createElement(f,i(i({ref:a},m),{},{components:n})):t.createElement(f,i({ref:a},m))}));function f(e,a){var n=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in a)hasOwnProperty.call(a,s)&&(l[s]=a[s]);l.originalType=e,l[c]="string"==typeof e?e:r,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}d.displayName="MDXCreateElement"},729:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var t=n(7462),r=(n(7294),n(3905));const o={},i="Data Mapping",l={unversionedId:"developer/micro-page/amis/data_mapping",id:"developer/micro-page/amis/data_mapping",title:"Data Mapping",description:"Data mapping is a powerful feature that allows users to fetch variable values from the current data chain by using template strings, such as $ or $xxx. This method is mainly used in scenarios like template strings, customizing API request body formats, etc.",source:"@site/docs/developer/micro-page/amis/4_data_mapping.md",sourceDirName:"developer/micro-page/amis",slug:"/developer/micro-page/amis/data_mapping",permalink:"/developer/micro-page/amis/data_mapping",draft:!1,editUrl:"https://github.com/steedos/steedos-docs/tree/master/docs/developer/micro-page/amis/4_data_mapping.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{},sidebar:"developer",previous:{title:"Template Rendering",permalink:"/developer/micro-page/amis/tpl"},next:{title:"Expressions",permalink:"/developer/micro-page/amis/expression"}},s={},p=[{value:"Customizing API Request Body Data Format",id:"customizing-api-request-body-data-format",level:3},{value:"Complex Configuration",id:"complex-configuration",level:3},{value:"Extracting Values from Arrays",id:"extracting-values-from-arrays",level:3},{value:"Namespace",id:"namespace",level:3}],m={toc:p},c="wrapper";function u(e){let{components:a,...n}=e;return(0,r.kt)(c,(0,t.Z)({},m,n,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"data-mapping"},"Data Mapping"),(0,r.kt)("p",null,"Data mapping is a powerful feature that allows users to fetch variable values from the current data chain by using template strings, such as ",(0,r.kt)("inlineCode",{parentName:"p"},"${xxx}")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"$xxx"),". This method is mainly used in scenarios like template strings, customizing API request body formats, etc."),(0,r.kt)("h3",{id:"customizing-api-request-body-data-format"},"Customizing API Request Body Data Format"),(0,r.kt)("p",null,"When submitting a form via an API, if the default request body data format of AMIS does not meet your expectations, you can use data mapping to customize the required data format. For example, if your backend API only supports a specific input data structure, you can customize the data format by configuring the ",(0,r.kt)("strong",{parentName:"p"},"data")," attribute of the API.\nFor instance:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "type": "page",\n  "body": {\n    "type": "form",\n    "api": {\n      "method": "post",\n      "url": "/amis/api/mock2/form/saveForm",\n      "data": {\n        "userName": "${name}",\n        "userEmail": "${email}"\n      }\n    },\n    "body": [\n      {\n        "type": "input-text",\n        "name": "name",\n        "label": "Name:"\n      },\n      {\n        "name": "email",\n        "type": "input-text",\n        "label": "Email:"\n      }\n    ]\n  }\n}\n')),(0,r.kt)("h3",{id:"complex-configuration"},"Complex Configuration"),(0,r.kt)("p",null,"AMIS allows the use of ",(0,r.kt)("inlineCode",{parentName:"p"},"&")," as a key in data mapping to expand the configured variables. This means you can expand all the properties of an object and concatenate them in the data.\nFor example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "type": "page",\n  "body": {\n    "type": "form",\n    "data": {\n      "a": "1",\n      "b": "2",\n      "c": {\n        "e": "3",\n        "f": "4",\n        "g": "5"\n      }\n    },\n    "api": {\n      "url": "/amis/api/mock2/form/saveForm",\n      "method": "post",\n      "data": {\n        "name": "${name}",\n        "email": "${email}",\n        "e": "${c.e}",\n        "f": "${c.f}",\n        "g": "${c.g}"\n      }\n    },\n    "body": [\n      {\n        "type": "input-text",\n        "name": "name",\n        "label": "Name:"\n      },\n      {\n        "name": "email",\n        "type": "input-text",\n        "label": "Email:"\n      }\n    ]\n  }\n}\n')),(0,r.kt)("h3",{id:"extracting-values-from-arrays"},"Extracting Values from Arrays"),(0,r.kt)("p",null,"You can configure the API's data attribute to extract only specific variables from an array and form a new array."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "type": "page",\n  "body": {\n    "type": "form",\n    "api": {\n      "method": "post",\n      "url": "/amis/api/mock2/form/saveForm",\n      "data": {\n        "items": {\n          "$table": {\n            "a": "${a}",\n            "c": "${c}"\n          }\n        }\n      }\n    },\n    "body": [\n      {\n        "type": "input-table",\n        "name": "table",\n        "label": "Table",\n        "columns": [\n          {\n            "label": "A",\n            "name": "a"\n          },\n          {\n            "label": "B",\n            "name": "b"\n          }\n        ],\n        "value": [\n          {\n            "a": "a1",\n            "b": "b1",\n            "c": "c1"\n          },\n          {\n            "a": "a2",\n            "b": "b2",\n            "c": "c2"\n          }\n        ]\n      }\n    ]\n  }\n}\n')),(0,r.kt)("h3",{id:"namespace"},"Namespace"),(0,r.kt)("p",null,"AMIS supports fetching data from different namespaces, such as global variables, localStorage, sessionStorage, and cookies."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"window")," refers to global variables."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ls")," refers to localStorage. If the value is a JSON object, it can be used directly as an object, for example: ",(0,r.kt)("inlineCode",{parentName:"li"},"${ls:xxxxxlocalStrorageKey.xxxx}")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ss")," refers to sessionStorage, similar to the above."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cookie")," refers to cookies, similar to the above.")),(0,r.kt)("p",null,"For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "type": "page",\n  "body": "The current page title is: <span class=\'label label-info\'>${window:document[title]}</span>"\n}\n')))}u.isMDXComponent=!0}}]);